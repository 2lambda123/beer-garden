<!doctype html>
<html lang='en' ng-app="bgApp">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title ng-bind="title"></title>

    <link href="index.css" rel="stylesheet">
    <link ng-if="themes.slate" ng-href="dark.css" rel="stylesheet">

    <!-- Favicon - this prevents the browser requesting favicon.ico before config is loaded -->
    <link rel="icon" href="data:,">
    <link rel="icon" ng-if="config.iconDefault" ng-href="image/{{config.iconDefault}}.png">
  </head>

  <body ng-cloak>

    <!-- Navbar Start -->
    <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom:0">

      <!-- Navbar Top Start -->
      <a style="cursor:pointer" class="navbar-brand" ui-sref="base.systems">
        <i ng-class="getIcon(config.iconDefault)"></i>
        <span ng-cloak>{{config.applicationName}}</span>
      </a>
      <ul class="nav navbar-nav navbar-top-links navbar-right">

        <li ng-show=!isUser(user)>

          <a href="" ng-click="doLogin()">
            <i class="fa fa-user"></i>
            <span>Login</span>
          </a>
        </li>

        <li ng-show="isUser(user)">
          <a href="">Hello, {{user.username}}!</a>
        </li>

        <li ng-show="isUser(user)">
          <i class="fa fa-user"></i>
          <a ng-click="doLogout()" href="">
            <i class="fa fa-user"></i>
            <span>Logout</span>
          </a>
        </li>

        <li ng-show="hasPermission(user, 'bg-command-read')">
              <a ui-sref="base.commands"
                 ng-class="{active: ($state.current.name.startsWith('command'))}">
                <i class="fa fa-fw fa-send-o"></i>
                <span>Commands</span>
              </a>
            </li>
            <li ng-show="hasPermission(user, 'bg-request-read')">
              <a ui-sref="base.requests"
                 ng-class="{active: ($state.current.name.startsWith('request'))}">
                <i class="fa fa-fw fa-tasks"></i>
                <span>Requests</span>
              </a>
            </li>
            <li ng-show="hasPermission(user, 'bg-job-read')">
              <a ui-sref="base.jobs"
                 ng-class="{active: ($state.current.name.startsWith('job'))}">
                <i class="fa fa-fw fa-calendar"></i>
                <span>Scheduler</span>
              </a>
            </li>

        <li class="dropdown" ui-sref-active="active">
          <a href="" class="dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-wrench fa-fw"></i>
            <span>Admin</span>
            <span class="caret"></span>
          </a>
          <ul class="dropdown-menu">
             <li>
                  <a ui-sref="base.system_admin" ui-sref-active="active">
                    <i class="fa fa-power-off"></i>
                    <span>Systems Management</span>
                  </a>
                </li>
                <li ng-show="hasPermission(user, 'bg-queue-read')">
                  <a ui-sref="base.queues" ui-sref-active="active">
                    <i class="fa fa-database"></i>
                    <span>Queue Management</span>
                  </a>
                </li>
                <li ng-show="hasPermission(user, 'bg-user-read')">
                  <a ui-sref="base.user_admin" ui-sref-active="active">
                    <i class="fa fa-user"></i>
                    <span>User Management</span>
                  </a>
                </li>
                <li ng-show="hasPermission(user, 'bg-role-read')">
                  <a ui-sref="base.role_admin" ui-sref-active="active">
                    <i class="fa fa-tag"></i>
                    <span>Role Management</span>
                  </a>
                </li>
                <li ng-show="hasPermission(user, 'bg-role-read')">
                  <a ui-sref="base.garden_admin" ui-sref-active="active">
                    <i class="fa fa-leaf"></i>
                    <span>Garden Management</span>
                  </a>
                </li>
          </ul>
        </li>

        <li class="dropdown">
          <a href="" class="dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-window-restore"></i>
            <span>Themes</span>
            <span class="caret"></span>
          </a>
          <ul class="dropdown-menu">
            <li ng-repeat="(style, enabled) in themes">
              <div style="padding: 3px 15px; cursor: pointer;"
                    ng-click="changeTheme(style, true)">
                <span class="fa" ng-class="{'fa-check': enabled, 'fa-fw': !enabled}"></span>
                <span>{{style}}</span>
              </div>
            </li>
          </ul>
        </li>

        <li>

          <a ui-sref="base.about" ui-sref-active="active">
            <i class="fa fa-info"></i>
            <span>About</span>
          </a>
        </li>
      </ul>
      <!-- Navbar Top End -->

      <!-- Sidebar Start -->
      <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
          <ul class="nav" id="side-menu" >
            <li ng-repeat="namespace in namespaces">
              <a>
                <i class="fa fa-cogs fa-fw"></i>
                <span>{{namespace}}</span>
                <span class="fa arrow"></span>
              </a>
              <ul class="nav nav-second-level">
                <li ng-repeat="system in systems" >
                  <a ui-sref="base.system({namespace: system.namespace, systemName: system.name, systemVersion: system.version})"
                     ui-sref-active="active"
                     ng-if="system.namespace == namespace">
                    <i class="fa fa-cog"></i>
                    <span>{{system.namespace}}</span>
                    <span>{{system.display_name || system.name}}</span>
                    <span>{{system.version}}</span>
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <!-- Sidebar End -->

    </nav>
    <!-- Navbar End -->

    <div id="page-wrapper">
      <div class="row">
        <div ui-view></div>
      </div>
    </div>

    <script src="index.js"></script>

  </body>
</html>
