# Integration Testing

These tests are meant to ensure that the different parts of Beer-garden work correctly together.

## On Travis
These tests are designed to be run on Travis. The setup will install the requirements.txt and then run `brew-view` and `bartender` in the background. Once the plugins come up Travis will run `pytest rest` to run all the tests.

## Running Locally

If you're running Beer-garden locally you can also run these tests yourself. Just modify `rest/config.json` to tell the tests where to find your Beer-garden and make sure you have `pytest` installed. Run `pytest rest` to kick things off.

## Parts
These tests are targeting different aspects of beergarden.

### Lifecycle
These test that bartender and brew-view can correctly start up and shut down

### Rest
These test the brew-view rest interface

### Config
These make sure that configuration file generation / upgrades work properly

#### Defaults
These are the files that should be generated by default

#### Migration
Each directory is a version.

The config files that are immediate children are config files that were used for that version.

Then there are additional version directories that are also direct children. The config files in those represent what a config file upgraded FROM that version would look like.

For example:
The 2.3.5 directory has configs file in it. These are files that would work with version 2.3.5.

The 2.4.0 directory also has configs. These are files that would work with version 2.4.0. However, the 2.4.0 directory also has a 2.3.6 directory. Those files are the "truth" for what upgrading a config file from 2.3.6 to 2.4.0 should look like.

When releasing a new version run generate config for both bartender and brewview. Put those files in a new version directory to serve as a source for future versions. Then create directories for each previous version and copy the generated configs into them. Then inspect the previous versions and manually change the new files to what you think the results of the migrations should be.

Then run the tests and correct any discrepencies.

### Upgrade
TODO
These test upgrading beer-garden from one version to another
