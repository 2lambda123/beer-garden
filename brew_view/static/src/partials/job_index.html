<h1 class='page-header'>
  <span>Request Scheduler</span>

  <button class="btn btn-primary pull-right" type="button"
          ng-if="jobs.loaded && !jobs.error && jobs.data.length !== 0"
          ui-sref="jobsCreate()">Schedule a Job</button>
</h1>

<loading      loader="jobs"></loading>
<server-error loader="jobs"></server-error>

<div class="container-fluid animate-if"
     ng-if="jobs.loaded && !jobs.error && jobs.data.length == 0">
  <br />
  <div class="jumbotron">
    <h1>Welcome to the Request Scheduler</h1>
    <p>
      The request scheduler is a way to take your favorite plugin's command
      and schedule it to run at a later date. In Beer Garden, we call these
      scheduled requests, "Jobs". Jobs can have many different triggers. This
      page will help guide you through creating your very own job.
    </p>
    <br />
    <p>
      <a role="button"
         class="btn btn-primary btn-block btn-lg"
         ui-sref="jobsCreate()">Create Your First Job</a>
    </p>
  </div>
</div>

<div class="container-fluid animate-if"
     ng-if="jobs.loaded && !jobs.error && jobs.data.length > 0">
  <table
      datatable="ng"
      dt-options="dtOptions"
      class="table table-striped table-bordered"
      style="width: 100%">
    <thead>
      <tr>
        <th id="th_job_name">Job Name</th>
        <th id="th_job_status">Job Status</th>
        <th id="th_system">System</th>
        <th id="th_instance">Instance</th>
        <th id="th_command">Command</th>
        <th id="th_next_run_time">Next Run Time</th>
        <th id="th_success_count">Sucess Count</th>
        <th id="th_error_count">Error Count</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="job in jobs.data | filter:query">
        <td>
          <a href="#!/jobs/{{job.id}}">{{job.name}}</a>
        </td>
        <td>{{job.status}}</td>
        <td>{{job.request_template.system}}</td>
        <td>{{job.request_template.instance_name}}</td>
        <td>{{job.request_template.command}}</td>
        <td>{{formatDate(job.next_run_time)}}</td>
        <td>{{job.success_count}}</td>
        <td>{{job.error_count}}</td>
      </tr>
    </tbody>
  </table>
</div>
